FROM python:3.13-slim-bookworm

ENV PYTHONDONTWRITEBYTECODE 1
ENV PYTHONUNBUFFERED 1

WORKDIR /app

COPY . /app/

RUN pip install uv

RUN uv pip install --system --no-cache-dir -r requirements.txt

ARG MAIL_PASSWORD
ARG MAIL_USERNAME
ARG MAIL_DEFAULT_SENDER
ARG MAIL_REPLY_TO
ARG SHEET_ID
ARG CALENDAR_ID

ENV MAIL_PASSWORD=$MAIL_PASSWORD
ENV MAIL_USERNAME=$MAIL_USERNAME
ENV MAIL_DEFAULT_SENDER=$MAIL_DEFAULT_SENDER
ENV MAIL_REPLY_TO=$MAIL_REPLY_TO
ENV SHEET_ID=$SHEET_ID
ENV CALENDAR_ID=$CALENDAR_ID

CMD ["gunicorn", "app:app", "--bind", "0.0.0.0:5000"]